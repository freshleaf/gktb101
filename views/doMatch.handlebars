{{#section 'head'}}
    <title>高考填报101</title>
    <meta name="description" content="查看历年高考分数线，学校分数线，专业分数线">
    <meta name="keywords" content="查看历年高考分数线，学校分数线，专业分数线">
{{/section}}

{{> header}}
<ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">首页</a></li>
    <li class="breadcrumb-item active">做匹配</li>
</ol>
<main role="main" class="container">
    <form>
        <div class="form-group row">
            <div class="col-auto col-form-label-sm">
                {{#if goal.items}}
                    <label id="target">已添加 <span class="text-primary font-weight-bold">{{goal.items.length}}</span> 个目标</label>
                    (
                    {{#if goal.type1}}
                        <label>文科:{{goal.type1}}</label>
                    {{/if}}
                    {{#if goal.type2}}
                        <label>理科:{{goal.type2}}</label>
                    {{/if}}
                    {{#if goal.type3}}
                        <label>综合:{{goal.type3}}</label>
                    {{/if}}
                    |
                    高校目标:{{universityGoalSize}}
                    专业目标:{{majorGoalSize}}
                    )
                {{/if}}
            </div>
        </div>
        <div class="form-group row">
            <div class="col-auto">
                <label for="studentLocation" class="col-form-label-sm">考生所在地</label>
            </div>
            <div class="col-auto">
                <select id="studentLocation" class="form-control form-control-sm" name="sl">
                    {{#each location}}
                        <option value="{{code}}"{{selected}}>{{name}}</option>
                    {{/each}}
                </select>
            </div>
            <div class="col-auto">
                <label for="type" class="col-form-label-sm">文理科</label>
            </div>
            <div class="col-auto">
                <select id="type" class="form-control form-control-sm" name="type">
                    {{#each type}}
                        <option value="{{code}}"{{selected}}>{{name}}</option>
                    {{/each}}
                </select>
            </div>
            <div class="col-auto">
                <label for="score" class="col-form-label-sm">高考分数</label>
            </div>
            <div class="input-group-sm">
                <input name="inputScore" type="number" class="form-control mx-sm-2 {{#if invalidScore}}is-invalid{{/if}}" placeholder="我的高考分数" {{#if usersetting.inputScore}}value="{{usersetting.inputScore}}"{{/if}} required>
                <label class="invalid-feedback">请输入合理的高考分数</label>
            </div>
        </div>

        <div class="d-flex justify-content-between">
            <div>
                {{#if goal.items}}
                    <button id="submitBtn" type="submit" class="btn btn-primary mb-1">做匹配</button>
                {{/if}}
                {{#unless goal.items}}
                    <label id="target">未添加目标</label>
                {{/unless}}
            </div>
            <div>
                <a href="/setGoal" class="btn btn-outline-primary btn-sm ml-2">跳转到目标设置页面</a>
                {{#if goalList}}
                    <button id="showDetails" type="button" class="btn btn-outline-primary btn-sm ml-2">隐藏历史数据</button>
                {{/if}}
            </div>
        </div>
    </form>
    <hr>
    {{#if goal.items}}
        {{#if goalList}}
            <div class="table-responsive-md">
                <table class="table table-bordered table-hover">
                    <caption>共匹配高校目标{{matchedUniversityGoalSize}}个，专业目标{{matchedMajorGoalSize}}个。匹配结果仅供参考。</caption>
                    <thead class="thead-light">
                    <tr>
                        <th>高校名称</th>
                        <th>专业名称</th>
                        <th>年份</th>
                        <th>文理科</th>
                        <th>批次</th>
                        <th>录取最高分</th>
                        <th>录取最低分</th>
                        <th>录取平均分</th>
                        <th>省控线</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each goalList}}
                        {{#if isFirstLine}}
                            <tr class="table-info">
                        {{/if}}
                        {{#unless isFirstLine}}
                            <tr class="text-muted">
                        {{/unless}}
                            <td>{{universityName}}</td>
                        {{#if isMajorGoal}}
                                <td>{{majorName}}</td>
                        {{/if}}
                        {{#unless isMajorGoal}}
                                <td class="text-info">大学录取线</td>
                        {{/unless}}
                            <td>{{year}}</td>
                            <td>{{studentType}}</td>
                            <td>{{batch}}</td>
                            <td>{{maxScore}}</td>
                            <td {{#if isFirstLine}}class="text-primary"{{/if}}>{{minScore}}</td>
                            <td>{{averageScore}}</td>
                            <td class="text-muted">{{provinceLine}}</td>
                        </tr>
                    {{/each}}
                    </tbody>
                </table>
            </div>
        {{/if}}
        {{#if isShowEmpty}}
            <p>未找到匹配目标数据，</p>
        {{/if}}
    {{/if}}

</main>
{{> footer}}

{{#section 'script'}}
    <script type="text/javascript">
        $(document).ready(function () {
            $('#showDetails').click(function () {
                var text = $(this).text();
                if (text == '显示历史数据') {
                    $(this).text('隐藏历史数据');
                    $(this).attr('action', 'hide');
                    $('tr.text-muted').removeAttr("hidden");
                } else if (text == '隐藏历史数据') {
                    $(this).text('显示历史数据');
                    $(this).attr('action', 'show');
                    $('tr.text-muted').attr("hidden", true);
                }
            });
        });
    </script>
{{/section}}